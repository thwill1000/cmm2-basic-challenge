' Copyright (c) Mauro Xavier 2021

DIM XP(2),YP(2),FX(4),FY(4),FA(4),FD(4),FS(4),PX(99),PY(99),CX(99),CY(99),PA(99),PM(99),PP(99),Z(99)
SUB PR F,T,X,Y,C,O,A$,Z,S:PG 1:FONT #F,T:COLOR S:FOR ZA=-Z TO Z+1:FOR ZB=-Z TO Z:?@(X+ZA,Y+ZB,1) A$;
NEXT:NEXT:COLOR O:?@(X+1,Y,1) A$;:COLOR C:?@(X,Y,1) A$;:END SUB:OPTION ANGLE DEGREES:YW=10^8:R=7.8^8
SUB HR:IF PU OR LF=0 THEN PLAY SOUND 4,B,Q,900,10 ELSE PLAY SOUND 4,B,O:END SUB:SUB MT C:SN C,"O",1
END SUB:SUB PG T:PAGE WRITE T:END SUB:XX=640:YY=400:TC=&HFF2800:W=10^8.4:N=&HFF00BF:SUB SN C,P$,F,V
EXECUTE "PLAY SOUND "+STR$(C)+",B,"+P$+","+STR$(F)+","+STR$(V):END SUB:MODE 2,8:DO:YD=7763456:V=V+1
YB=50^4:Y=200:LF=Y-V*2:DN=300:U=4^11:GO=0:DD=0:SETTICK 0,HR:PLAY STOP:X=0:L=.1:IF SV=0 THEN SC=0:V=2
DO WHILE KEYDOWN(1)<>32 AND SV=0:PG 1:CLS 99:T=COS(I)*1+1:PR 3,3,82,145,R,R,"HOPE ROBOT",T,R:B=255
PR 7,2,4,4,W,W,"HIGH SCORE:"+FORMAT$(HS,"%06.0f"),2:S=T*99:PR 7,2,238,DN,S,S,"PRESS SPACE",2:I=I+30
PR 1,1,230,385,W,W,"MAURO XAVIER - 2021",2:PAGE COPY 1 TO 0:SN 1,"T",T*75+1,25:LOOP:CLS TC:PG 2:SV=0
MS$="GAME OVER":D=0:S=65:MATH SET 0,FA():MATH SET 0,PA():SETTICK 25,HR:AN=0:TIMER=0:UP=99:CLS TC
BOX 0,170,XX,60,0,,U:DO WHILE LF>=0:PG 2:SW=G MOD 2:RA=RND*10-5:RB=RND*10-5:A=XX-M:IF WL<1 THEN CP=U
WL=WL-1:UP=MAX(P,MIN(DN-80,UP)):DN=MAX(UP+80,MIN(380,DN)):BOX A,0,M,YY,0,,TC:BOX A,UP,M,DN-UP,0,,CP
FOR T=0 TO 19 STEP 4:C=RGB(255-T*9,40-T,0):BOX A,UP+T,M,2,0,,C:BOX A,DN-T,M,2,0,,C:NEXT:CP=YD:DG=G*H
SX=-6*(X>610):M=V+X\35:IF RND>0.8 THEN:DO WHILE I<=39:INC I:IF PA(I)=0 THEN:PM(I)=0:CX(I)=-RND*4-M
PA(I)=3:PY(I)=UP+5+RND*(DN-UP-9):PP(I)=R:PX(I)=XX:CY(I)=RND*8-4:Z(I)=RND*3+2:I=40:ENDIF:LOOP:ENDIF
PG 1:FOR T=0 TO XX STEP 30:DG=DG+12:BLIT T,0,T,COS(DG)*8,30,YY,2:NEXT:IF TIMER>999 AND LF>0 THEN
PT=680:SY=0:PAGE SCROLL 2,-M,0,0:UP=UP+RA:DN=DN+RB:FOR T=1 TO 4:K=KEYDOWN(T):IF K=32*(F+1) THEN F=1
SX=SX+((K=131)-(K=130))*3:SY=SY+((K=129)-(K=128))*3:NEXT:GO=1:ELSE:EN=0:ENDIF:TX$="SAVED":S=S-SGN(S)
SC=SC+IS*(1-DD):D=D+SY:S=S+SX:X=X+S/10:Y=Y+D/10:SN 1,EG$,(9-S\13)\3+TM,9:EG$="N":IF X<0 THEN X=0:S=0
SS=S:SS=MAX(-5,MIN(9,SS)):D=D-SGN(D)*(SY=0):D=MAX(-40,MIN(40,D)):XP(1)=X+COS(D+120)*TM:IS=M/50+SV*50
XP(0)=X+COS(D)*P:YP(0)=Y+SIN(D)*P:YP(1)=Y+SIN(D+120)*TM:YP(1)=Y+SIN(D+120)*TM:XP(2)=X+COS(D+240)*TM
YP(2)=Y+SIN(D+240)*TM:PG 1:POLYGON 3,XP(),YP(),0,&HBBBB:XP(0)=X-COS(D)*(SS+M*7):YP(0)=Y-SIN(D*2)*P
H=H-L:MT 2:TT=M-V:PU=TIMER MOD (((LF\50)+1)*250)<200:IF SW THEN POLYGON 3,XP(),YP(),U,RGB(127,0,0)
IF EN=0 THEN:IF RND<0.01 THEN:YS=RND*6-3:YE=UP+P+RND*(DN-UP-P):XS=-RND*V:XE=PT:EN=GO:ER=0:ENDIF:ELSE
INC ER,15:EA=COS(ER)*4+15:A=L*(2*(XE<X)-1):INC XS,A:INC YE,YS:INC XE,XS-M:C=L*(2*(YE<Y)-1):INC YS,C
Q=Q+YS:K=0:FOR T=Q TO 360+Q STEP P:A=-COS(T)*EA:C=-SIN(T)*EA:LINE XE,YE,XE-A*1.4,YE-C*1.4,1,W
O=PIXEL(XE-A,YE-C):IF O=TC OR O=YD THEN:MT 3:INC XS,A/5:INC YS,C/5:INC XE,A:INC YE,C:ENDIF:NEXT
CIRCLE XE,YE,EA,,,0,N:SN 3,"T",EA*15,P:IF XE<0 OR XE>PT THEN:EN=0:MT 3:ENDIF:ENDIF:FOR T=1 TO 4:PG 1
IF FA(T)=1 THEN:INC FX(T),14-TT:INC FS(T),-1:INC FY(T),FD(T):IF FX(T)>XX OR FY(T)<0 OR FY(T)>YY THEN
FA(T)=0:ELSEIF FS(T)>1 THEN:SN 2,"W",FS(T)*50,25:ENDIF:LINE FX(T)-30,FY(T)-FD(T)*2,FX(T),FY(T),1,YW
FOR E=1 TO 9:O=PIXEL(FX(T)+E,FY(T)):IF (O=TC OR O=N OR O=YD) THEN:PC=YB:A=3:FA(T)=30:IF O=TC THEN
PC=R:H=50:A=-8:ELSEIF O=N THEN:PC=7.3^8:IS=150:A=25:EN=0:ENDIF:LF=LF+A:MT 3:EXIT FOR:ENDIF:NEXT
ENDIF:IF KEYDOWN(T)=32 THEN:K=2:ENDIF:IF FA(T)>1 THEN:PG 1:C=FA(T)*8+9:A=RGB(C,C,C):INC FX(T),-M
SN 3,"N",61-FA(T)*2,25:INC FA(T),-3:CIRCLE FX(T),FY(T),35-FA(T),,,YW,A:IF FA(T)<3 THEN:FA(T)=0:PG 2
MT 3:CIRCLE FX(T),FY(T),33,1,1,U,U:ENDIF:I=0:PT=0:DO WHILE I<=39 AND PT<10:IF PA(I)=0 THEN:PP(I)=PC
PX(I)=FX(T):PA(I)=1:CX(I)=RND*7-5:CY(I)=RND*8-4:Z(I)=4:INC PT:PM(I)=0:PY(I)=FY(T)+(YY-FY(T))/99
ENDIF:INC I:LOOP:ENDIF:PG 2:A=X+COS(D)*35:IF FA(T)=0 AND F=1 THEN:FY(T)=Y+SIN(D)*50:FA(T)=1:FX(T)=A
F=2:FD(T)=D/2:FS(T)=10:EXIT FOR:ENDIF:NEXT:ENDIF:F=K:IF LF>349 THEN:LF=350:MS$=TX$+"!!":SV=1:ENDIF
G=1+G MOD 360:TM=COS(AN)*4+9:IF RND>0.99 AND GO THEN:WL=9:ENDIF:P=20:FOR I=0 TO 39:IF PA(I)>0 THEN:
PG 1:INC PY(I),CY(I):INC PX(I),CX(I)-M-PA(I):J=PP(I):O=PIXEL(PX(I),PY(I)):IF PX(I)<0 THEN PA(I)=0
IF O=TC OR O=YD THEN INC PM(I):CX(I)=-CX(I)/4:CY(I)=-CY(I)/4:IF PM(I)>6 THEN PA(I)=0:PG 2
CIRCLE PX(I),PY(I),Z(I),,,J,J:ENDIF:NEXT:FOR T=0 TO 360 STEP 45:A=COS(T)*15+5:C=SIN(T)*TM:PG 1
I=PIXEL(X+A,Y+C):IF I=TC OR I=N OR I=YD THEN:S=S-A:D=D-C*2:EG$="W":LF=LF-1:ENDIF:NEXT:HS=MAX(HS,SC)
IF LF<1 OR SV=1 THEN:D=0:S=0:LF=SV*300:IF DD=0 THEN:PLAY STOP:TIMER=0:ENDIF:IF TIMER>4^6 THEN LF=-1
DD=1:EN=0:PR 3,3+SV,95,145,YW,B,MS$,3,B*SW:ELSE:LF=LF-L:INC AN,M*3:BOX 50,18,LF,9,1,0,B+PU*W:I=-1
BOX 50,18,350,9,1,W:PR 1,1,11,16,W,B,"LIFE",1:ENDIF:TY$="SCORE:"+FORMAT$(SC,"%06.0f")+"  "+TX$+":"
PR 1,1+DD*2,11-DD*2,4,W,B,TY$+STR$(V-2),1+DD:H=MAX(14-LF\10,MIN(99,H)):PAGE COPY 1 TO 0,I:LOOP:LOOP
